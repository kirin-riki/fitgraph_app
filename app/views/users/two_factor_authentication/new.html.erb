<main class="w-full min-h-screen flex flex-col items-center bg-gray-50 pt-10 pb-24">
  <section class="w-full max-w-md bg-white rounded-2xl shadow-xl px-6 py-8 mx-4">
    <h2 class="text-xl font-bold text-center text-blue-700 mb-6 tracking-wide">2段階認証コードを入力してください</h2>
    <%= form_with url: user_two_factor_authentication_path, method: :post, class: "space-y-6" do |f| %>
      <div>
        <%= f.label :otp_attempt, "認証コード", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :otp_attempt, autofocus: true, autocomplete: "one-time-code", class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-400 focus:border-blue-400 bg-gray-50" %>
      </div>
      <%= f.submit "認証", class: "w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow transition" %>
    <% end %>
    <% if flash[:alert] %>
      <div class="mt-6 text-center text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-4 py-2 shadow-sm"><%= flash[:alert] %></div>
    <% end %>
    <p>Debug: current_user = <%= current_user.inspect %></p>
    <p>Debug: user_signed_in? = <%= user_signed_in? %></p>
    <p>Debug: pre_2fa_user = <%= pre_2fa_user.inspect %></p>
    <p>Debug: session[:user_id] = <%= session[:user_id].inspect %></p>
  </section>
</main>